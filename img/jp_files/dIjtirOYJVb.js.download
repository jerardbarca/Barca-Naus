if (self.CavalryLogger) { CavalryLogger.start_js(["mZH5T"]); }

__d("MInitJewelCounts",["Arbiter"],(function(a,b,c,d,e,f,g){"use strict";function a(a){g.inform("m:jewels:init-counts",a,"persistent")}e.exports={main:a}}),null);
__d("isNodeWithinRect",[],(function(a,b,c,d,e,f){function a(a,b){if(!a.getBoundingClientRect)return!1;a=a.getBoundingClientRect();return a.bottom>=b.top&&a.top<=b.bottom&&a.right>=b.left&&a.left<=b.right}e.exports=a}),null);
__d("MTabbable",["MAria","MJSEnvironment","MViewport","isNodeWithinRect"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();function k(a,b){while(a&&a!==b){if(g.isHidden(a))return!0;a=a.parentNode}return!1}function l(a,b){if(a.offsetHeight===0||a.offsetWidth===0||window.getComputedStyle(a).visibility==="hidden"||parseInt(a.tabIndex,10)<0||k(a,b))return!1;if(a.tabIndex>=0)return!0;switch(a.tagName){case"A":return a.href&&a.rel!="ignore";case"INPUT":return a.type!="hidden"&&a.type!="file"&&!a.disabled;case"BUTTON":case"SELECT":case"TEXTAREA":return!a.disabled}return!1}function a(a){__p&&__p();if(!a.getBoundingClientRect)return;var b=h.IS_APPLE_WEBKIT_IOS&&parseFloat(h.OS_VERSION)>=8||h.BROWSER_NAME==="Safari"&&!h.IS_APPLE_WEBKIT_IOS;b=b?a.querySelectorAll("a, button, select, [tabindex]"):a.querySelectorAll("a, button, input, select, textarea, [tabindex]");var c=i.getBoundingRect();for(var d=0,e;e=b[d];d++)if(l(e,a)&&j(e,c)){e.focus();return}}f.focusTabbable=a}),null);
__d("Popover",["CSS","DOM","MAria","MViewport","Stratcom","Vector","$","eventsMixinDeprecated","nullthrows","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){__p&&__p();var q=40;function r(a){"use strict";__p&&__p();var b=a.flyout;b=typeof b==="string"?m(b):b;this.flyout=b;this.content=h.scry(this.flyout,"div","flyout-content")[0];this.options=a;this._onOrientationChange=this._reposition.bind(this);g.conditionClass(this.flyout,"popover_flyout",!0);b=a.button;b&&(b=typeof b==="string"?m(b):b,this.buttonClickListener=h.listen(b,"click",null,this._openHandler.bind(this)),b.setAttribute("role","button"),i.setupPopup(b,this.flyout),this.button=b);b=a.flyoutAnchor;b?this.flyoutAnchor=typeof b==="string"?m(b):b:this.flyoutAnchor=this.button;this.options.flyoutFromRoot&&(this.flyoutClickListener=h.listen(this.flyout,"click",null,this._openHandler.bind(this)));this.options.touchstart_callback&&(this.flyoutTouchStartListener=h.listen(this.flyout,"touchstart",null,this._touchStartHandler.bind(this)));this.options.touchmove_callback&&(this.flyoutTouchMoveListener=h.listen(this.flyout,"touchmove",null,this._touchMoveHandler.bind(this)));this.options.touchend_callback&&(this.flyoutTouchEndListener=h.listen(this.flyout,"touchend",null,this._touchEndHandler.bind(this)));r._instances[this.flyout.id]=this}r.prototype.isOpen=function(){"use strict";return!!this._isOpen};r.prototype.open=function(){"use strict";__p&&__p();if(this.isOpen())return;r._activePopover&&r._activePopover.close();r._activePopover=this;this._isOpen=!0;this.constraint=null;g.conditionClass(this.flyout,"popover_hidden",!1);this.options.flyoutFromRoot&&this._absolutePositionFlyout();this._position();this.options.heightConstraint||(g.conditionClass(o(document.body),"disableClicks",!0),this.globalListener=k.listenCapture("click",null,this._closeHandler.bind(this)));window.addEventListener("orientationchange",this._onOrientationChange,!1);i.showPopup(this.button,this.flyout);if(this.options.ensureVisible){var a=j.getScrollTop(),b=this._getElementPosition(this.flyout).y,c=b+this.flyout.offsetHeight;c=c-(a+j.getUseableHeight());if(c>0){c=Math.min(c,Math.max(b-a-q,0));j.scrollTo(0,a+c)}}this.invoke("open")};r.prototype.close=function(a){"use strict";__p&&__p();if(!this.isOpen())return;r._activePopover=null;this._isOpen=!1;g.conditionClass(this.flyout,"popover_hidden",!0);this.options.flyoutFromRoot&&this.flyoutParent&&(this.flyoutParent.appendChild(this.flyout),delete this.flyoutParent);p(function(){g.conditionClass(o(document.body),"disableClicks",!1)}.bind(this),400);this.globalListener&&this.globalListener.remove();window.removeEventListener("orientationchange",this._onOrientationChange,!1);this._releaseConstraint();i.hidePopup(this.button,this.flyout);a||this.invoke("close")};r.prototype.clear=function(){"use strict";this.globalListener&&this.globalListener.remove(),this.buttonClickListener&&this.buttonClickListener.remove(),this.flyoutClickListener&&this.flyoutClickListener.remove(),this.flyoutTouchStartListener&&this.flyoutTouchStartListener.remove(),this.flyoutTouchMoveListener&&this.flyoutTouchMoveListener.remove(),this.flyoutTouchEndListener&&this.flyoutTouchEndListener.remove(),delete r._instances[this.flyout.id]};r.prototype.refreshConstraints=function(){"use strict";if(!this._isOpen)return!1;var a=this.flyout;this._releaseConstraint();this.options.heightConstraint?(a.style.minHeight=j.getUseableHeight()+"px",this.constraint=j.addHeightConstraint(l.getDim(this.content).y+this._getElementPosition(a).y)):this.constraint=j.addMinHeightConstraint(l.getDim(a).y+this._getElementPosition(a).y+r._MARGIN)};r.prototype._getTouchPoint=function(event){"use strict";var a,b=event.getRawEvent();b instanceof TouchEvent&&(a=b.targetTouches[0]);b={x:a?a.screenX:0,y:a?a.screenY:0};return b};r.prototype._touchStartHandler=function(event){"use strict";var a=this.options.touchstart_callback;a&&a(this._getTouchPoint(event))};r.prototype._touchMoveHandler=function(event){"use strict";if(this.isOpen()){var a=this.options.touchmove_callback;a&&a(this._getTouchPoint(event))}};r.prototype._touchEndHandler=function(event){"use strict";var a=this.options.touchend_callback;a&&a(this._getTouchPoint(event))};r.prototype._openHandler=function(event){"use strict";__p&&__p();event.prevent();var a=this.isOpen();if(a&&!this.options.preventClose)this.close();else if(!a){a=h.scry(document,"input");for(var b=0;b<a.length;b++)a[b].blur();this.open()}};r.prototype._closeHandler=function(event){"use strict";event.getNode("popover")||this.close()};r.prototype._getElementPosition=function(a){"use strict";__p&&__p();a=a;var b=a.offsetLeft,c=a.offsetTop;a=a.offsetParent;while(a&&a!==document.documentElement){b+=a.offsetLeft;c+=a.offsetTop;var d=window.getComputedStyle(a);b+=parseInt(d.getPropertyValue("border-left-width").slice(0,-2),10);c+=parseInt(d.getPropertyValue("border-top-width").slice(0,-2),10);a=a.offsetParent}return new l(b,c)};r.prototype._absolutePositionFlyout=function(){"use strict";this.flyoutParent=this.flyout.parentNode;m("root").appendChild(this.flyout);var a=this._getElementPosition(this.flyout.parentNode),b=this._getElementPosition(this.flyoutAnchor),c=l.getDim(this.flyoutAnchor);b=b.y-a.y+c.y;this.flyout.style.position="absolute";this.flyout.style.top=b+"px"};r.prototype._position=function(){"use strict";var a=this.flyout;if(this.flyoutAnchor&&this.options.positionNub){var b=this._getElementPosition(this.flyoutAnchor),c=h.find(this.flyout,"*","nub"),d=l.getDim(c).x,e=l.getDim(this.flyoutAnchor).x;a=this._getElementPosition(a);new l(b.x-a.x+(e-d)/2,0).setPos(c)}this.refreshConstraints()};r.prototype._reposition=function(){"use strict";p(this._position.bind(this),0)};r.prototype._releaseConstraint=function(){"use strict";this.constraint&&(this.constraint.release(),this.constraint=null)};r.getInstance=function(a){"use strict";return r._instances[a]};r.clearAll=function(){"use strict";for(var a=0;a<r._instances.length;a++)r._instances[a].clear()};r._activePopover=null;r._MARGIN=40;r._instances={};n(r,["open","close"]);e.exports=r}),null);
__d("MJewelFlyout",["CSS","DOM","EventEmitter","MHistory","MJSEnvironment","MLogState","MTabbable","MViewport","Popover","Stratcom","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";__p&&__p();var r="acw",s="aclb",t=3e3;function u(a,b,c){this.$1=b,this.$2=a,this.$3=c,this.$7=new i()}u.prototype.isOpen=function(){return!!this.$9&&this.$9.isOpen()};u.prototype.open=function(){this.$9&&this.$9.open()};u.prototype.close=function(){this.$9&&this.$9.close()};u.prototype.$10=function(){var a=new o({button:h.find(this.$2,"*","icon"),flyout:this.$1,ensureVisible:!1,heightConstraint:!0,preventClose:!0});this.$9=a;this.$4=a.listen("open",this.$11.bind(this));this.$5=a.listen("close",this.$12.bind(this));this.$6=h.listen(this.$1,"click",null,this.$13.bind(this));k.IS_ANDROID&&k.GET_OS_VERSION>=4&&(this.$8=h.scry(this.$1,"div","scroll-area")[0])};u.prototype.clear=function(){this.$4&&this.$4.remove(),this.$5&&this.$5.remove(),this.$6&&this.$6.remove(),this.$9&&this.$9.clear()};u.prototype.reregisterListeners=function(){var a=this.isOpen();this.clear();this.$10();a&&this.open()};u.prototype.addOpenListener=function(a){return this.$7.addListener("open",a)};u.prototype.$11=function(){if(this.$8){n.scrollToHeader();var a=document.documentElement;a&&(g.conditionClass(a,"hide-scroll",!0),this.$8.style.maxHeight=a.offsetHeight-200+"px")}j.pushSoftState(this.$3.softState);this.$7.emit("open");p.invoke("m:jewel:flyout:open",this.$3.sigil,{jewel:this.$3.sigil});m.focusTabbable(this.$1)};u.prototype.$12=function(){if(this.$8){this.$8.style.minHeight="";var a=document.documentElement;a&&g.conditionClass(a,"hide-scroll",!1)}p.invoke("m:jewel:flyout:close",this.$3.sigil,{jewel:this.$3.sigil});j.popSoftState(this.$3.softState)};u.prototype.$13=function(event){l.updateLink(event,this.$3.pos)};u.prototype.$14=function(event){event.kill()};u.prototype.setHeaderText=function(a,b){if(!a||!b)return;a=h.scry(this.$1,"*",a)[0];if(!a)return;var c=a.cloneNode(!0);c.innerText=b;h.replace(a,c)};u.removeMenuContent=function(a){a=document.getElementById(a);a&&h.remove(a)};u.updateMenuColor=function(a,b,c){c?q(u.$15.bind(this,a,b),t):u.$15(a,b)};u.$15=function(a,b){a=document.getElementById(a);a&&(g.conditionClass(a,s,!b),g.conditionClass(a,r,b))};u.create=function(a,b,c){a=new u(a,b,c);a.$10();return a};e.exports=u}),null);
__d("MJewel",["CSS","DOM","MJewelFlyout","Stratcom","URI","$","eventsMixinDeprecated","intlNumUtils"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){__p&&__p();var o=0;p.create=function(a,b){"use strict";a=new p(a,b);a._init();return a};function p(a,b){"use strict";this._count=0,this._sigil=a,this.options=b||{},this._jewelNode=l(p.JEWEL_NAV_NODE_ID),this._softState=b.softState||"jewel="+o++,this._contentsSigil=b.contentsSigil||"contents",this._additionalPaths=b.additionalPaths||[],this._noPopover=!!b.noPopover,this._preventClearBadge=!!b.preventClearBadge}p.prototype._init=function(){"use strict";if(!this._noPopover){var a=i.create(this._getJewelElement(),this._getFlyoutElement(),{sigil:this._sigil,softState:this._softState,pos:this.options.pos});a.addOpenListener(this.handleViewedContent.bind(this));this._flyout=a}j.listen("m:history:change",null,this._updateJewelsOnHistoryChange.bind(this))};p.prototype._updateJewelsOnHistoryChange=function(event){"use strict";event.getData().soft===this._softState?this._flyout&&this._flyout.open():this._flyout&&this._flyout.close(),this._updateIsJewelActive(event)};p.prototype.isInitialized=function(){"use strict";return!!h.scry(this._jewelNode,"*",this._contentsSigil)[0]};p.prototype._getJewelElement=function(){"use strict";return h.find(this._jewelNode,"div",this._sigil)};p.prototype._getCountElement=function(){"use strict";return h.find(this._getJewelElement(),"span","count")};p.prototype._getContentsElement=function(){"use strict";return h.find(this._getJewelElement(),"*",this._contentsSigil)};p.prototype._getFlyoutElement=function(){"use strict";return h.find(this._getJewelElement(),"*","flyout")};p.prototype.getCount=function(){"use strict";return this._count};p.prototype.getFlyout=function(){"use strict";return this._flyout};p.prototype._updateCountElement=function(){"use strict";var a=this._getJewelCount();h.setContent(this._getCountElement(),n.formatNumberWithThousandDelimiters(a));a=this._getJewelElement();var b=this._count>0;g.conditionClass(a,"noCount",!b);g.conditionClass(a,"hasCount",b)};p.prototype._updateIsJewelActive=function(event){"use strict";var a=new k(event.getData().path);a=a.getPath();var b=event.getData().soft;a=!b&&this._additionalPaths.includes(a);b=b===this._softState;g.conditionClass(this._getJewelElement(),"popoverOpen",b||a)};p.prototype.setCount=function(a){"use strict";if(a<0)return;this._count=a;this._updateCountElement()};p.prototype.updateCount=function(a,b){"use strict";!this.isOpen()?this.setCount(a):a&&b()};p.prototype.handleViewedContent=function(){"use strict";this.getCount()>0&&this.isInitialized()?(this._preventClearBadge||this.setCount(0),this.invoke("cleared")):this.invoke("jewel_click")};p.prototype._getJewelCount=function(){"use strict";if(this._count>0)return this._count;else return 0};p.prototype.isOpen=function(){"use strict";return!!this._flyout&&this._flyout.isOpen()};p.prototype.reregisterListeners=function(){"use strict";var a=this._flyout;a&&a.reregisterListeners()};p.JEWEL_NAV_NODE_ID="mJewelNav";m(p,["cleared","jewel_click"]);e.exports=p}),null);
__d("FriendingSurfaceVisitationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.BASIC)};a.prototype.logVital=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,g.VITAL)};a.prototype.logImmediately=function(){h.log("logger:FriendingSurfaceVisitationLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppVersion=function(a){this.$1.app_version=a;return this};a.prototype.setBadgeCount=function(a){this.$1.badge_count=a;return this};a.prototype.setClientTimestamp=function(a){this.$1.client_timestamp=a;return this};a.prototype.setRawRefTab=function(a){this.$1.raw_ref_tab=a;return this};a.prototype.setRawTab=function(a){this.$1.raw_tab=a;return this};a.prototype.setRefPage=function(a){this.$1.ref_page=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.setTargetProfileID=function(a){this.$1.target_profile_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};b={app_version:!0,badge_count:!0,client_timestamp:!0,raw_ref_tab:!0,raw_tab:!0,ref_page:!0,surface:!0,target_profile_id:!0,vc:!0};e.exports=a}),null);
__d("XFriendRequestIHEventLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/requests/interaction_history_logging/",{target_id:{type:"FBID",required:!0},log_event:{type:"String",required:!0}})}),null);
__d("MFriendRequestIHEventLogger",["DOM","FBJSON","MRequest","XFriendRequestIHEventLoggingController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();a={listenToProfileClick:function(a,b,c){a=h.parse(a.getAttribute("data-store"));var d=a.userid?a.userid.toString():null;g.listen(c,"click",null,function(){this.logClick(d)}.bind(this));g.listen(b,"click",null,function(){this.logClick(d)}.bind(this))},logImpression:function(a){a&&this._logEvent(a,"impression")},logClick:function(a){a&&this._logEvent(a,"click")},_logEvent:function(a,event){if(isNaN(a))return;a=j.getURIBuilder().setFBID("target_id",a).setString("log_event",event).getURI();new i(a).send()}};e.exports=a}),null);
__d("XExpireFriendRequestsMutationController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/requests/expire/",{from_m_jewel:{type:"Bool",defaultValue:!1}})}),null);
__d("MFriendingJewel",["Arbiter","DOM","FriendingSurfaceVisitationTypedLogger","MarauderLogger","MFriendRequestIHEventLogger","MJewel","MJewels","MLegacyDataStore","MLogState","MPymkFunnelLogger","MRequest","MURI","Popover","Stratcom","XExpireFriendRequestsMutationController","invariant"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";__p&&__p();var w="/friends/center/requests/",x="/friends/center/kaios/",y,z=!1,A=!1,B=!1;function C(){__p&&__p();y||v(0,2795);g.subscribe("m:jewels:init-counts",D,"all");y.listen("cleared",I);y.listen("jewel_click",F);if(A)return;A=!0;t.listen("jewel_requests_add",null,K);t.listen("jewel_requests_remove_old",null,K);t.listen("friend_requests_expired",null,L);t.listen("jewel_friending_notifs",null,K);t.listen("mobile_requests_count",null,K);t.listen("friend_requests_seen",null,M);t.listen("m:requests:refresh",null,N);t.listen("removed_item_hidden_event",null,N);t.listen("m:jewel:flyout:open",null,E)}function D(event,a){a=a.request_count;if(!y||!a)return;y.reregisterListeners();y.updateCount(a,I)}function E(event){var a=event.getData();if(a.jewel!=="requests")return;new q(u.getURIBuilder().setBool("from_m_jewel",!0).getURI()).send()}function F(){y||v(0,2795),G(),new i().setSurface("jewel").setBadgeCount(y.getCount()).log(),O.lazyLoadRequestsJewelIfTabOpen()}function G(){__p&&__p();y||v(0,2795);var a=y._getContentsElement();if(!a)return;a=h.scry(a,"div","attachment");var b=[];for(var c=0;c<a.length;c++){var d=a[c].getAttribute("id");d&&d.startsWith("m_jewel_req_")&&(b=b.concat(d.replace("m_jewel_req_","")))}if(b.length){d=new q("/friends/requests/log_impressions");d.setMethod("POST");d.addData({ids:b.join(","),ref:"m_jewel"});d.send()}}function H(){__p&&__p();if(z)return;y||v(0,2795);z=!0;var a=y._getContentsElement();a=h.scry(a,"div","undoable-action");for(var b=0;b<a.length;b++){var c=a[b].getAttribute("data-pymk-id");if(c){var d=a[b].getAttribute("data-signature");p.logImpression(c,d,"mobile_jewel")}else{c=n.get(a[b]).userid;j.log("request_seen","friend_request_waterfall",{request_id:c,request_location:"requests_jewel"});k.logImpression(c?c.toString():null)}}}function I(){t.invoke("m_requests_jewel_mark_read");var a=new q(new r("/a/jewel_requests_read.php").toString());a.send()}function J(){new q("/ajax/mobile/friends/jewel/requests_markup").send()}function K(){if(!y)return;if(y.isOpen())return;J()}function L(){if(!y)return;J()}function M(event){if(!y||B)return;y.setCount(0)}function N(){var a=s.getInstance("reqs_flyout");a&&a.refreshConstraints()}var O={initJewel:function(a){y=l.create("requests",{pos:o.CLICK_POSITION_REQUESTS_FLYOUT,softState:m.REQUESTS,noPopover:a.shouldRedirectRequestsJewel,additionalPaths:[w,x],preventClearBadge:a.preventClearBadge}),B=a.preventClearBadge,C()},lazyLoadRequestsJewelIfTabOpen:function(){if(y&&y.isOpen()){var a=y._getContentsElement();if(t.hasSigil(a,"requests-flyout-pagelet-placeholder"))return;t.hasSigil(a,"requests-flyout-loading")?J():H()}},onAfterUpdateFriendRequests:function(a){if(!y)return;!y.isOpen()?y.setCount(a):a&&I();N();y.isOpen()&&H()},onAfterLoadMoreFriendSuggestions:function(){if(!y)return;N()}};e.exports=O}),null);
__d("MMessagesThreadRowID",[],(function(a,b,c,d,e,f){"use strict";var g="other_user_fbid_",h="thread_fbid_";function a(a,b,c){return a+(b?g+b:h+String(c))}e.exports={getThreadRowID:a}}),null);
__d("MessagingEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DELETE:"delete",DELETE_MESSAGES:"delete_messages",DELIVER:"deliver",ERROR:"error",READ:"read",REPORT_SPAM:"report_spam",REPORT_SPAM_MESSAGES:"report_spam_messages",UNMARK_SPAM:"unmark_spam",SUBSCRIBE:"subscribe",CHANGE_MUTE_SETTINGS:"change_mute_settings",TAG:"tag",UNREAD:"unread",UNSUBSCRIBE:"unsubscribe",DELIVER_LOG:"deliver_log",MARK_ALL_READ:"mark_all_read",MARK_ALL_SEEN:"mark_all_seen",MORE_THREADS:"more_threads",READ_ALL:"read_all",READ_RECEIPT:"read_receipt",DELIVERY_RECEIPT:"delivery_receipt",SENT_PUSH:"sent_push",DELIVER_FAST_PAST:"deliver_fast_path",MESSENGER_STATUS:"messenger_status",UPDATE_PINNED_THREADS:"update_pinned_threads",CHANGE_PAGE_THREAD_FLAG:"change_page_thread_flag",CREATE_PAGE_ADMIN_NOTE:"create_page_admin_note",NO_OP:"no_op"})}),null);
__d("XFBConfirmationCliffTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.BASIC)};a.prototype.logVital=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,g.VITAL)};a.prototype.logImmediately=function(){h.log("logger:XFBConfirmationCliffLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setCliffCaller=function(a){this.$1.cliff_caller=a;return this};a.prototype.setError=function(a){this.$1.error=a;return this};a.prototype.setSurface=function(a){this.$1.surface=a;return this};a.prototype.updateExtraData=function(a){a=i(h.serializeMap(a));h.checkExtraDataFieldNames(a,j);this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};var j={cliff_caller:!0,error:!0,surface:!0};e.exports=a}),null);
__d("XMessagesJewelContentController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mobile/messages/jewel/content/",{spinner_id:{type:"String",required:!0}})}),null);
__d("MMessagesJewel",["Arbiter","ChannelEventType","DOM","MessagingEvent","MJewel","MJewelFlyout","MJewels","MLogState","MMessagesThreadRowID","MRequest","MURI","Popover","Stratcom","XFBConfirmationCliffTypedLogger","XMessagesJewelContentController","fbt","invariant"],(function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){"use strict";__p&&__p();var x="mJewelMsgThreadContents",y="msg_",z,A=!1,B,C=!1;function D(){z||w(0,2795),g.subscribe("m:jewels:init-counts",E,"all"),z.listen("cleared",G),C||(C=!0,s.listen(h.MESSAGE,null,K),s.listen(h.MESSAGE,null,H),s.listen("m:jewel:flyout:open",null,F))}function E(event,a){__p&&__p();var b=a.viewer_id,c=a.unseen_thread_ids;a=a.unread_thread_ids;b&&(M.viewerID=b);c&&(M.unseenThreadIDs=c.reduce(function(a,b){a[b]=1;return a},{}));a&&(M.unreadThreadIDs=a.reduce(function(a,b){a[b]=1;return a},{}));c&&z&&(z.reregisterListeners(),z.updateCount(c.length,G))}function F(event){var a=event.getData();if(!z||a.jewel!=="messages")return;M.messengerCliff&&new t().setSurface("messenger_seen").log();a=z.getCount();z.setCount(a);J()}function G(){var a=new p(new q("/a/jewel_messages_read.php").toString());a.send()}function H(event){__p&&__p();var a=event.getData();if(!a||!z)return;if(a.event===j.READ&&a.message.folder==="inbox"){var b=a.message.thread_fbid||a.message.other_user_fbid;delete M.unseenThreadIDs[b];delete M.unreadThreadIDs[b]}else if(a.event===j.UNREAD&&a.message.folder==="inbox"){b=a.message.thread_fbid||a.message.other_user_fbid;M.unreadThreadIDs[b]=1}else if(a.event===j.MARK_ALL_READ&&a.message.folder==="inbox")M.unreadThreadIDs={},M.unseenThreadIDs={};else if(a.event===j.MARK_ALL_SEEN&&a.message.folder==="inbox")M.unseenThreadIDs={};else if(a.parsedPayload&&a.folder==="inbox"){b=a.parsedPayload;if(!I(M.viewerID,b)||b.isUnread()===!1||a.message.is_muted)return;a=b.getThreadFBID()||b.getOtherUserFBID();M.unseenThreadIDs[a]=1;M.unreadThreadIDs[a]=1}else return;b=Object.keys(M.unseenThreadIDs).length;a=Object.keys(M.unreadThreadIDs).length;!z.isOpen()&&b!==z.getCount()&&z.setCount(b);b=a>0?v._("Messages ({unread_message_count})",[v._param("unread_message_count",a)]):v._("Messages");a=z.getFlyout();a&&a.setHeaderText("messages_jewel_header_text",b.toString())}function I(a,b){if(!b.getParticipantIDs())return!1;if(b.getParticipantIDs().indexOf(a)>-1)return!0;if(a)return b.getParticipantIDs().indexOf(a.toString())>-1;else return!1}function J(){z||w(0,2795);var a=z._getJewelElement(),b="messages-flyout-loading";a=i.scry(a,"*",b);if(a.length>0){b=u.getURIBuilder().setString("spinner_id",a[0].getAttribute("id")).getURI();B||(B=new p(b),B.listen("finally",function(){B=null}),B.send())}}function K(event){__p&&__p();var a=event.getData();if(!a||!z)return;if(a.parsedPayload){var b=a.parsedPayload;if(!b.getFolder||b.getFolder()!=="inbox"||!I(M.viewerID,b))return;z.isInitialized()&&(l.removeMenuContent(L(b.getOtherUserFBID(),b.getThreadFBID())),z.isOpen()&&G());A||J()}else a.event===j.READ&&a.is_sync&&l.updateMenuColor(L(a.message.other_user_fbid,a.message.thread_fbid),!0,!1)}function L(a,b){return o.getThreadRowID(y,a,b)}var M={unseenThreadIDs:{},unreadThreadIDs:{},viewerID:null,messengerCliff:!1,initJewel:function(a){A=!!a.noFlyout,z=k.create("messages",{contentsSigil:x,pos:n.CLICK_POSITION_MESSAGES_FLYOUT,softState:m.MESSAGES,noPopover:A,additionalPaths:["/messages/"]}),D()},setMessengerCliff:function(a,b,c){M.messengerCliff=a},refreshMessagesConstraints:function(){r.getInstance("messages_flyout").refreshConstraints()}};e.exports=M}),null);
__d("MQuickPromotionEmbeddedInterstitial",["DOM","MRequest","Stratcom","XQuickPromotionSimpleLoggingController"],(function(a,b,c,d,e,f,g,h,i,j){__p&&__p();var k=!1;a=function(a,b,c){__p&&__p();if(k)return;k=!0;function d(event){i.removeCurrentListener();var b=event.getNode(a.promo);g.hide(b);b=g.find(event.getNode(a.jewel),"div",a.sibling);g.show(b);i.invoke("m:qp:embedded-interstitial:close")}function e(event){if(event.getData().jewel==a.jewel){i.removeCurrentListener();var d=j.getURIBuilder().setInt("qp_id",b).setStringToStringMap("qp_instance_log_data",c).setString("qp_event","view").getURI();d=new h(d);d.send()}}i.listen("click",a.close,d);i.listen("m:jewel:flyout:open",null,e)};f.main=a}),null);
__d("MPopoverClose",["Popover"],(function(a,b,c,d,e,f,g){a=function(){g._activePopover&&g._activePopover.close()};f.main=a}),null);